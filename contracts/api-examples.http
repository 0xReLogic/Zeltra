# Zeltra API Examples
# Use with REST Client extension (VS Code) or similar

@baseUrl = http://localhost:8080/api/v1
@accessToken = {{login.response.body.access_token}}

### ============ AUTH ============

### Register
# @name register
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "SecureP@ss123",
  "full_name": "Test User"
}

### Login
# @name login
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "SecureP@ss123"
}

### Refresh Token
POST {{baseUrl}}/auth/refresh
Content-Type: application/json

{
  "refresh_token": "{{login.response.body.refresh_token}}"
}

### Logout
POST {{baseUrl}}/auth/logout
Authorization: Bearer {{accessToken}}

### Verify Email
POST {{baseUrl}}/auth/verify-email
Content-Type: application/json

{
  "token": "verification-token-from-email"
}

### Resend Verification Email
POST {{baseUrl}}/auth/resend-verification
Content-Type: application/json

{
  "email": "test@example.com"
}

### ============ ORGANIZATIONS ============

### List Organizations
GET {{baseUrl}}/organizations
Authorization: Bearer {{accessToken}}

### Create Organization
# @name createOrg
POST {{baseUrl}}/organizations
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "name": "Acme Corp",
  "slug": "acme-corp",
  "base_currency": "USD",
  "timezone": "Asia/Jakarta"
}

@orgId = {{createOrg.response.body.id}}

### Get Organization Detail
GET {{baseUrl}}/organizations/{{orgId}}
Authorization: Bearer {{accessToken}}

### Update Organization
PATCH {{baseUrl}}/organizations/{{orgId}}
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "name": "Acme Corporation",
  "timezone": "America/New_York"
}

### List Organization Users
GET {{baseUrl}}/organizations/{{orgId}}/users
Authorization: Bearer {{accessToken}}

### Add User to Organization
POST {{baseUrl}}/organizations/{{orgId}}/users
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "email": "newuser@example.com",
  "role": "approver",
  "approval_limit": "5000.00"
}

### Update User Role
PATCH {{baseUrl}}/organizations/{{orgId}}/users/user-uuid
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "role": "admin",
  "approval_limit": null
}

### Remove User from Organization
DELETE {{baseUrl}}/organizations/{{orgId}}/users/user-uuid
Authorization: Bearer {{accessToken}}

### ============ ACCOUNTS ============

### List Accounts
GET {{baseUrl}}/accounts
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### List Expense Accounts (filtered)
GET {{baseUrl}}/accounts?type=expense&active=true
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Create Account
# @name createAccount
POST {{baseUrl}}/accounts
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "code": "1100",
  "name": "Cash on Hand",
  "account_type": "asset",
  "account_subtype": "current_asset",
  "currency": "USD",
  "is_active": true,
  "allow_direct_posting": true
}

@accountId = {{createAccount.response.body.id}}

### Get Account Detail
GET {{baseUrl}}/accounts/{{accountId}}
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Update Account
PUT {{baseUrl}}/accounts/{{accountId}}
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "name": "Petty Cash",
  "is_active": true
}

### Toggle Account Status
PATCH {{baseUrl}}/accounts/{{accountId}}/status
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "status": "inactive"
}

### Delete Account (Soft Delete)
DELETE {{baseUrl}}/accounts/{{accountId}}
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Get Account Balance
GET {{baseUrl}}/accounts/{{accountId}}/balance?as_of=2026-01-31
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Get Account Ledger
GET {{baseUrl}}/accounts/{{accountId}}/ledger?from=2026-01-01&to=2026-01-31
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### ============ TRANSACTIONS ============

### List Transactions
GET {{baseUrl}}/transactions?status=posted&page=1&limit=20
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Create Transaction (Single Currency)
# @name createTxn
POST {{baseUrl}}/transactions
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "transaction_type": "expense",
  "transaction_date": "2026-01-15",
  "description": "Office supplies purchase",
  "entries": [
    {
      "account_id": "expense-account-uuid",
      "source_currency": "USD",
      "source_amount": "150.00",
      "entry_type": "debit",
      "memo": "Printer paper and ink",
      "dimensions": ["department-uuid"]
    },
    {
      "account_id": "cash-account-uuid",
      "source_currency": "USD",
      "source_amount": "150.00",
      "entry_type": "credit"
    }
  ]
}

@txnId = {{createTxn.response.body.id}}

### Create Transaction (Multi-Currency)
POST {{baseUrl}}/transactions
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "transaction_type": "expense",
  "transaction_date": "2026-01-15",
  "description": "International software subscription",
  "entries": [
    {
      "account_id": "expense-account-uuid",
      "source_currency": "EUR",
      "source_amount": "1000.00",
      "entry_type": "debit",
      "dimensions": ["department-uuid", "project-uuid"]
    },
    {
      "account_id": "bank-account-uuid",
      "source_currency": "EUR",
      "source_amount": "1000.00",
      "entry_type": "credit"
    }
  ]
}

### Get Transaction Detail
GET {{baseUrl}}/transactions/{{txnId}}
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Update Transaction (Draft only)
PATCH {{baseUrl}}/transactions/{{txnId}}
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "description": "Updated description",
  "transaction_date": "2026-01-16"
}

### Delete Transaction (Draft only)
DELETE {{baseUrl}}/transactions/{{txnId}}
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### ============ TRANSACTION WORKFLOW ============

### Submit for Approval
POST {{baseUrl}}/organizations/{{orgId}}/transactions/{{txnId}}/submit
Authorization: Bearer {{accessToken}}

### Approve Transaction
POST {{baseUrl}}/organizations/{{orgId}}/transactions/{{txnId}}/approve
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "approval_notes": "Approved - within budget"
}

### Post Transaction
POST {{baseUrl}}/organizations/{{orgId}}/transactions/{{txnId}}/post
Authorization: Bearer {{accessToken}}

### Reject Transaction
POST {{baseUrl}}/organizations/{{orgId}}/transactions/{{txnId}}/reject
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "rejection_reason": "Missing supporting documentation"
}

### Void Transaction (Posted only)
POST {{baseUrl}}/organizations/{{orgId}}/transactions/{{txnId}}/void
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "void_reason": "Duplicate entry - correcting error"
}

### Get Pending Transactions (Approval Queue)
GET {{baseUrl}}/organizations/{{orgId}}/transactions/pending
Authorization: Bearer {{accessToken}}

### Bulk Approve Transactions
POST {{baseUrl}}/organizations/{{orgId}}/transactions/bulk-approve
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "transaction_ids": [
    "transaction-uuid-1",
    "transaction-uuid-2",
    "transaction-uuid-3"
  ],
  "approval_notes": "Batch approved - month-end processing"
}

### ============ APPROVAL RULES ============

### List Approval Rules
GET {{baseUrl}}/organizations/{{orgId}}/approval-rules
Authorization: Bearer {{accessToken}}

### Create Approval Rule
# @name createRule
POST {{baseUrl}}/organizations/{{orgId}}/approval-rules
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "name": "Large Expense Approval",
  "min_amount": "10000.00",
  "max_amount": null,
  "transaction_types": ["expense", "journal"],
  "required_role": "admin",
  "priority": 1
}

@ruleId = {{createRule.response.body.id}}

### Get Approval Rule
GET {{baseUrl}}/organizations/{{orgId}}/approval-rules/{{ruleId}}
Authorization: Bearer {{accessToken}}

### Update Approval Rule
PATCH {{baseUrl}}/organizations/{{orgId}}/approval-rules/{{ruleId}}
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "name": "Large Expense Approval (Updated)",
  "min_amount": "5000.00"
}

### Delete Approval Rule (Soft Delete)
DELETE {{baseUrl}}/organizations/{{orgId}}/approval-rules/{{ruleId}}
Authorization: Bearer {{accessToken}}

### ============ FISCAL YEARS & PERIODS ============

### List Fiscal Years
GET {{baseUrl}}/fiscal-years
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Create Fiscal Year
# @name createFiscalYear
POST {{baseUrl}}/fiscal-years
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "name": "FY 2026",
  "start_date": "2026-01-01",
  "end_date": "2026-12-31"
}

@fiscalYearId = {{createFiscalYear.response.body.id}}

### Update Fiscal Period Status
PATCH {{baseUrl}}/fiscal-periods/period-uuid/status
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "status": "closed"
}

### ============ CURRENCIES & EXCHANGE RATES ============

### List Currencies
GET {{baseUrl}}/currencies
Authorization: Bearer {{accessToken}}

### Get Exchange Rate
GET {{baseUrl}}/exchange-rates?from=EUR&to=USD&date=2026-01-15
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Create/Update Exchange Rate
POST {{baseUrl}}/exchange-rates
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "from_currency": "EUR",
  "to_currency": "USD",
  "rate": "1.0850",
  "effective_date": "2026-01-15"
}

### Bulk Import Exchange Rates
POST {{baseUrl}}/exchange-rates/bulk
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "rates": [
    { "from_currency": "EUR", "to_currency": "USD", "rate": "1.0850", "effective_date": "2026-01-15" },
    { "from_currency": "GBP", "to_currency": "USD", "rate": "1.2650", "effective_date": "2026-01-15" },
    { "from_currency": "JPY", "to_currency": "USD", "rate": "0.0067", "effective_date": "2026-01-15" }
  ]
}

### ============ DIMENSIONS ============

### List Dimension Types
GET {{baseUrl}}/dimension-types
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Create Dimension Type
# @name createDimType
POST {{baseUrl}}/dimension-types
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "name": "Cost Center",
  "code": "COST_CENTER",
  "is_required": false
}

@dimTypeId = {{createDimType.response.body.id}}

### List Dimension Values
GET {{baseUrl}}/dimension-values?type_id={{dimTypeId}}
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Create Dimension Value
POST {{baseUrl}}/dimension-values
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "dimension_type_id": "{{dimTypeId}}",
  "code": "CC001",
  "name": "Marketing",
  "is_active": true
}

### Update Dimension Value
PATCH {{baseUrl}}/dimension-values/dim-value-uuid
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "name": "Marketing & Sales",
  "code": "CC001-A"
}

### Toggle Dimension Value Status
PATCH {{baseUrl}}/dimension-values/dim-value-uuid/status
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "status": "inactive"
}

### ============ BUDGETS ============

### List Budgets
GET {{baseUrl}}/budgets
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Create Budget
# @name createBudget
POST {{baseUrl}}/budgets
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "name": "Q1 2026 Operating Budget",
  "fiscal_year_id": "fiscal-year-uuid",
  "budget_type": "operating"
}

@budgetId = {{createBudget.response.body.id}}

### Get Budget Detail
GET {{baseUrl}}/budgets/{{budgetId}}
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Add Budget Line
POST {{baseUrl}}/budgets/{{budgetId}}/lines
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "account_id": "expense-account-uuid",
  "fiscal_period_id": "period-uuid",
  "amount": "50000.00",
  "dimensions": ["department-uuid"]
}

### Lock Budget
POST {{baseUrl}}/budgets/{{budgetId}}/lock
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Get Budget vs Actual
GET {{baseUrl}}/budgets/{{budgetId}}/vs-actual
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### ============ REPORTS ============

### Trial Balance
GET {{baseUrl}}/reports/trial-balance?as_of=2026-01-31
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Balance Sheet
GET {{baseUrl}}/reports/balance-sheet?as_of=2026-01-31
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Income Statement
GET {{baseUrl}}/reports/income-statement?from=2026-01-01&to=2026-01-31
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Dimensional Report
GET {{baseUrl}}/reports/dimensional?dimension_type=DEPARTMENT&from=2026-01-01&to=2026-01-31
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### ============ DASHBOARD ============

### Dashboard Metrics
GET {{baseUrl}}/dashboard/metrics?period_id=period-uuid
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Cash Flow Data
GET {{baseUrl}}/dashboard/cash-flow?months=6
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Recent Activity (All)
GET {{baseUrl}}/dashboard/recent-activity?limit=10&type=all
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Recent Activity (Transactions Only)
GET {{baseUrl}}/dashboard/recent-activity?limit=20&type=transaction
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Budget vs Actual Dashboard
GET {{baseUrl}}/dashboard/budget-vs-actual?period_id=period-uuid
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### ============ ATTACHMENTS ============

### Upload Attachment (Get Presigned URL)
POST {{baseUrl}}/attachments/upload
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "filename": "receipt.pdf",
  "content_type": "application/pdf",
  "size": 102400
}

### Get Attachment
GET {{baseUrl}}/attachments/attachment-uuid
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### Delete Attachment
DELETE {{baseUrl}}/attachments/attachment-uuid
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### List Transaction Attachments
GET {{baseUrl}}/transactions/{{txnId}}/attachments
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}

### ============ SIMULATION ============

### Run Simulation/Projection
POST {{baseUrl}}/simulation/project
Authorization: Bearer {{accessToken}}
X-Organization-ID: {{orgId}}
Content-Type: application/json

{
  "base_period_id": "period-uuid",
  "projection_months": 12,
  "adjustments": [
    {
      "account_id": "revenue-account-uuid",
      "adjustment_type": "percentage",
      "value": "10"
    },
    {
      "account_id": "expense-account-uuid",
      "adjustment_type": "fixed",
      "value": "5000.00"
    }
  ]
}
